{"parsed":{"_path":"/2021/simple-blog-generate","_dir":"2021","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"实现一个简单的静态博客生成器","description":"作为一名程序员，写博客是积累知识、提升水平必不可少的一个方法。我们写博客主要有三种方法，一种是使用掘金、博客园、CSDN 等博客网站，第二种是自己搭建网站，存放自己的博客，第三种就是使用静态博客生成器，将生成的网页部署到服务器或者 github pages、gitee pages 等服务上。","excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"作为一名程序员，写博客是积累知识、提升水平必不可少的一个方法。我们写博客主要有三种方法，一种是使用掘金、博客园、CSDN 等博客网站，第二种是自己搭建网站，存放自己的博客，第三种就是使用静态博客生成器，将生成的网页部署到服务器或者 github pages、gitee pages 等服务上。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这三种方法中，第一种自由度太低，并且定制样式很麻烦；第二种每写一篇博客都要新建个页面，非常麻烦。因此我选择了第三种方法，在使用了 hexo、vuepress，gridea 等多种静态博客生成器后，我决定自己写一个来提升自己的能力。"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"项目地址："},{"type":"element","tag":"a","props":{"href":"https://github.com/qiyuor2/CoinRailgun","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/qiyuor2/CoinRailgun"}]}]}]},{"type":"element","tag":"h2","props":{"id":"明确需求"},"children":[{"type":"text","value":"明确需求"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"首先我们要明确需求，确定我们想要的效果"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"初始化博客文件夹，载入模板"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn init"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"根据模板创建 markdown 文件，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn new \"Hello CoinRailgun\""}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"根据 markdown 文件生成 html 文件，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn build"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"本地运行网站，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn server"}]}]}]},{"type":"element","tag":"h2","props":{"id":"开始编写"},"children":[{"type":"text","value":"开始编写"}]},{"type":"element","tag":"h3","props":{"id":"安装依赖"},"children":[{"type":"text","value":"安装依赖"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"根据上面我们分析出来的需求，确定出我们所需要的依赖，并且安装好他们"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"art-template"}]},{"type":"text","value":"编写模板所用的模板引擎"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"commander"}]},{"type":"text","value":"用来编写 cli"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dayjs"}]},{"type":"text","value":"处理时间"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"front-matter"}]},{"type":"text","value":"处理 markdown 顶部的 yml 声明"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"fs-extra"}]},{"type":"text","value":"fs 的扩充模块"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"glob"}]},{"type":"text","value":"匹配指定文件名"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"highlight.js"}]},{"type":"text","value":"高亮代码块"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"koa"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"koa-static"}]},{"type":"text","value":"启动本地服务"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"markdown-it"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"markdown-it-anchor"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"markdown-it-toc-done-right"}]},{"type":"text","value":"解析 markdown"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"uslug"}]},{"type":"text","value":"解析锚点的汉字"}]}]},{"type":"element","tag":"code","props":{"code":"\"dependencies\": {\n  \"art-template\": \"^4.13.2\",\n  \"commander\": \"^7.0.0\",\n  \"dayjs\": \"^1.10.4\",\n  \"front-matter\": \"^4.0.2\",\n  \"fs-extra\": \"^9.1.0\",\n  \"glob\": \"^7.1.6\",\n  \"highlight.js\": \"^10.5.0\",\n  \"koa\": \"^2.13.1\",\n  \"koa-static\": \"^5.0.0\",\n  \"markdown-it\": \"^12.0.4\",\n  \"markdown-it-anchor\": \"^7.0.1\",\n  \"markdown-it-toc-done-right\": \"^4.2.0\",\n  \"uslug\": \"^1.0.4\"\n}\n","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"\"dependencies\": {\n  \"art-template\": \"^4.13.2\",\n  \"commander\": \"^7.0.0\",\n  \"dayjs\": \"^1.10.4\",\n  \"front-matter\": \"^4.0.2\",\n  \"fs-extra\": \"^9.1.0\",\n  \"glob\": \"^7.1.6\",\n  \"highlight.js\": \"^10.5.0\",\n  \"koa\": \"^2.13.1\",\n  \"koa-static\": \"^5.0.0\",\n  \"markdown-it\": \"^12.0.4\",\n  \"markdown-it-anchor\": \"^7.0.1\",\n  \"markdown-it-toc-done-right\": \"^4.2.0\",\n  \"uslug\": \"^1.0.4\"\n}\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"搭建项目结构"},"children":[{"type":"text","value":"搭建项目结构"}]},{"type":"element","tag":"code","props":{"code":".\n├─ bin\n│    └─ crn.js  # 执行文件\n├─ lib  # crn.js调用的各个函数\n│    ├─ build.js\n│    ├─ clean.js\n│    ├─ new.js\n│    ├─ preview.js\n│    └─ init.js\n├─ package.json\n└─ template # 模板\n       ├─ site.config.json # 配置文件\n       └─ theme # 主题\n              └─ default # 默认主题\n                     ├─ assets\n                     └─ layout\n","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":".\n├─ bin\n│    └─ crn.js  # 执行文件\n├─ lib  # crn.js调用的各个函数\n│    ├─ build.js\n│    ├─ clean.js\n│    ├─ new.js\n│    ├─ preview.js\n│    └─ init.js\n├─ package.json\n└─ template # 模板\n       ├─ site.config.json # 配置文件\n       └─ theme # 主题\n              └─ default # 默认主题\n                     ├─ assets\n                     └─ layout\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"crnjs"},"children":[{"type":"text","value":"crn.js"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"同样，根据需求将各个命令、命令的参数和说明先写出来"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"关于"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"commander"}]},{"type":"text","value":"具体如何使用，可以查看"},{"type":"element","tag":"a","props":{"href":"https://github.com/tj/commander.js/blob/master/Readme_zh-CN.md","rel":["nofollow"]},"children":[{"type":"text","value":"commander 文档"}]}]},{"type":"element","tag":"code","props":{"code":"#! /usr/bin/env node\n\nconst program = require('commander');\nconst version = require('../package.json').version;\n\nprogram\n  .version(version)\n  .command('init [dir]')\n  .description('初始化博客')\n  .action(require('../lib/init'));\n\nprogram\n  .command('new <name>')\n  .description('创建新的文章')\n  .action(require('../lib/new.js'));\n\nprogram\n  .command('server [dir]')\n  .description('本地预览网站')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/preview.js'));\n\nprogram\n  .command('build [dir]')\n  .description('将文章渲染为html')\n  .option('-o, --output <dir>', '输出目录')\n  .action(require('../lib/build'));\n\nprogram\n  .command('clean')\n  .description('清空build出来的静态文件')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/clean.js'));\n\nprogram.parse(process.argv);\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"#! /usr/bin/env node\n\nconst program = require('commander');\nconst version = require('../package.json').version;\n\nprogram\n  .version(version)\n  .command('init [dir]')\n  .description('初始化博客')\n  .action(require('../lib/init'));\n\nprogram\n  .command('new <name>')\n  .description('创建新的文章')\n  .action(require('../lib/new.js'));\n\nprogram\n  .command('server [dir]')\n  .description('本地预览网站')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/preview.js'));\n\nprogram\n  .command('build [dir]')\n  .description('将文章渲染为html')\n  .option('-o, --output <dir>', '输出目录')\n  .action(require('../lib/build'));\n\nprogram\n  .command('clean')\n  .description('清空build出来的静态文件')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/clean.js'));\n\nprogram.parse(process.argv);\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"init"},"children":[{"type":"text","value":"init"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"初始化的时候可以传入一个目录，表示准备初始化的目录，这里我用了"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ES2020"}]},{"type":"text","value":"的新语法"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dir = dir ?? '.'"}]},{"type":"text","value":"，当"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dir"}]},{"type":"text","value":"为"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"null"}]},{"type":"text","value":"或"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"undefined"}]},{"type":"text","value":"时，使用问号右边的值。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在初始化的时候，需要明确好用户使用的目录应该是什么样的"}]},{"type":"element","tag":"code","props":{"code":"Blog\n├─ build\n├─ site.config.json\n├─ source\n│    └─ _posts\n│           └─ blog.md\n└─ theme\n       └─ default\n              ├─ assets\n              └─ layout\n","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Blog\n├─ build\n├─ site.config.json\n├─ source\n│    └─ _posts\n│           └─ blog.md\n└─ theme\n       └─ default\n              ├─ assets\n              └─ layout\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"将预先准备好的模板根据设计的目录拷贝到目标目录下，而不是直接调用项目中的，因为拷贝到目标目录下后，使用者就可以更方便的自定义模板，可以更方便的写自己的样式。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"关于"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"fs-extra"}]},{"type":"text","value":"模块的各种 API 可以查看"},{"type":"element","tag":"a","props":{"href":"https://github.com/jprichardson/node-fs-extra","rel":["nofollow"]},"children":[{"type":"text","value":"fs-extra 文档"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"关于"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dayjs"}]},{"type":"text","value":"可以查看"},{"type":"element","tag":"a","props":{"href":"https://dayjs.gitee.io/zh-CN/","rel":["nofollow"]},"children":[{"type":"text","value":"dayjs 文档"}]}]},{"type":"element","tag":"code","props":{"code":"const path = require('path');\nconst fs = require('fs-extra');\nconst dayjs = require('dayjs');\n\nmodule.exports = (dir) => {\n  dir = dir ?? '.';\n\n  const templateDir = path.resolve(__dirname, '..', 'template');\n  fs.copySync(templateDir, path.resolve(dir));\n  fs.ensureDirSync(path.resolve(dir, 'source'));\n\n  newPost(dir);\n};\n\nfunction newPost(dir) {\n  const firstPost = [\n    '---',\n    'title: Hello World',\n    'date: ' + dayjs().format('YYYY/MM/DD HH:mm:ss'),\n    'tags: ' + '[blog,CoinRailgunn]',\n    'category: ' + 'welcome',\n    '---',\n    '',\n    'Welcome to my blog, this is my first post',\n    '\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const path = require('path');\nconst fs = require('fs-extra');\nconst dayjs = require('dayjs');\n\nmodule.exports = (dir) => {\n  dir = dir ?? '.';\n\n  const templateDir = path.resolve(__dirname, '..', 'template');\n  fs.copySync(templateDir, path.resolve(dir));\n  fs.ensureDirSync(path.resolve(dir, 'source'));\n\n  newPost(dir);\n};\n\nfunction newPost(dir) {\n  const firstPost = [\n    '---',\n    'title: Hello World',\n    'date: ' + dayjs().format('YYYY/MM/DD HH:mm:ss'),\n    'tags: ' + '[blog,CoinRailgunn]',\n    'category: ' + 'welcome',\n    '---',\n    '',\n    'Welcome to my blog, this is my first post',\n    '\n"}]}]}]}]},"date":"2021/02/07 19:55:00","tags":["nodejs","JavaScript","blog","website","cli"],"category":"技术","summary":"作为一名程序员，写博客是积累知识、提升水平必不可少的一个方法。我们写博客主要有三种方法，一种是使用掘金、博客园、CSDN 等博客网站，第二种是自己搭建网站，存放自己的博客，第三种就是使用静态博客生成器，将生成的网页部署到服务器或者 github pages、gitee pages 等服务上。这...","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"作为一名程序员，写博客是积累知识、提升水平必不可少的一个方法。我们写博客主要有三种方法，一种是使用掘金、博客园、CSDN 等博客网站，第二种是自己搭建网站，存放自己的博客，第三种就是使用静态博客生成器，将生成的网页部署到服务器或者 github pages、gitee pages 等服务上。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这三种方法中，第一种自由度太低，并且定制样式很麻烦；第二种每写一篇博客都要新建个页面，非常麻烦。因此我选择了第三种方法，在使用了 hexo、vuepress，gridea 等多种静态博客生成器后，我决定自己写一个来提升自己的能力。"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"项目地址："},{"type":"element","tag":"a","props":{"href":"https://github.com/qiyuor2/CoinRailgun","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/qiyuor2/CoinRailgun"}]}]}]},{"type":"element","tag":"h2","props":{"id":"明确需求"},"children":[{"type":"text","value":"明确需求"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"首先我们要明确需求，确定我们想要的效果"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"初始化博客文件夹，载入模板"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn init"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"根据模板创建 markdown 文件，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn new \"Hello CoinRailgun\""}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"根据 markdown 文件生成 html 文件，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn build"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"本地运行网站，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"crn server"}]}]}]},{"type":"element","tag":"h2","props":{"id":"开始编写"},"children":[{"type":"text","value":"开始编写"}]},{"type":"element","tag":"h3","props":{"id":"安装依赖"},"children":[{"type":"text","value":"安装依赖"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"根据上面我们分析出来的需求，确定出我们所需要的依赖，并且安装好他们"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"art-template"}]},{"type":"text","value":"编写模板所用的模板引擎"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"commander"}]},{"type":"text","value":"用来编写 cli"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dayjs"}]},{"type":"text","value":"处理时间"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"front-matter"}]},{"type":"text","value":"处理 markdown 顶部的 yml 声明"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"fs-extra"}]},{"type":"text","value":"fs 的扩充模块"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"glob"}]},{"type":"text","value":"匹配指定文件名"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"highlight.js"}]},{"type":"text","value":"高亮代码块"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"koa"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"koa-static"}]},{"type":"text","value":"启动本地服务"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"markdown-it"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"markdown-it-anchor"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"markdown-it-toc-done-right"}]},{"type":"text","value":"解析 markdown"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"uslug"}]},{"type":"text","value":"解析锚点的汉字"}]}]},{"type":"element","tag":"code","props":{"code":"\"dependencies\": {\n  \"art-template\": \"^4.13.2\",\n  \"commander\": \"^7.0.0\",\n  \"dayjs\": \"^1.10.4\",\n  \"front-matter\": \"^4.0.2\",\n  \"fs-extra\": \"^9.1.0\",\n  \"glob\": \"^7.1.6\",\n  \"highlight.js\": \"^10.5.0\",\n  \"koa\": \"^2.13.1\",\n  \"koa-static\": \"^5.0.0\",\n  \"markdown-it\": \"^12.0.4\",\n  \"markdown-it-anchor\": \"^7.0.1\",\n  \"markdown-it-toc-done-right\": \"^4.2.0\",\n  \"uslug\": \"^1.0.4\"\n}\n","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"\"dependencies\": {\n  \"art-template\": \"^4.13.2\",\n  \"commander\": \"^7.0.0\",\n  \"dayjs\": \"^1.10.4\",\n  \"front-matter\": \"^4.0.2\",\n  \"fs-extra\": \"^9.1.0\",\n  \"glob\": \"^7.1.6\",\n  \"highlight.js\": \"^10.5.0\",\n  \"koa\": \"^2.13.1\",\n  \"koa-static\": \"^5.0.0\",\n  \"markdown-it\": \"^12.0.4\",\n  \"markdown-it-anchor\": \"^7.0.1\",\n  \"markdown-it-toc-done-right\": \"^4.2.0\",\n  \"uslug\": \"^1.0.4\"\n}\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"搭建项目结构"},"children":[{"type":"text","value":"搭建项目结构"}]},{"type":"element","tag":"code","props":{"code":".\n├─ bin\n│    └─ crn.js  # 执行文件\n├─ lib  # crn.js调用的各个函数\n│    ├─ build.js\n│    ├─ clean.js\n│    ├─ new.js\n│    ├─ preview.js\n│    └─ init.js\n├─ package.json\n└─ template # 模板\n       ├─ site.config.json # 配置文件\n       └─ theme # 主题\n              └─ default # 默认主题\n                     ├─ assets\n                     └─ layout\n","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":".\n├─ bin\n│    └─ crn.js  # 执行文件\n├─ lib  # crn.js调用的各个函数\n│    ├─ build.js\n│    ├─ clean.js\n│    ├─ new.js\n│    ├─ preview.js\n│    └─ init.js\n├─ package.json\n└─ template # 模板\n       ├─ site.config.json # 配置文件\n       └─ theme # 主题\n              └─ default # 默认主题\n                     ├─ assets\n                     └─ layout\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"crnjs"},"children":[{"type":"text","value":"crn.js"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"同样，根据需求将各个命令、命令的参数和说明先写出来"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"关于"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"commander"}]},{"type":"text","value":"具体如何使用，可以查看"},{"type":"element","tag":"a","props":{"href":"https://github.com/tj/commander.js/blob/master/Readme_zh-CN.md","rel":["nofollow"]},"children":[{"type":"text","value":"commander 文档"}]}]},{"type":"element","tag":"code","props":{"code":"#! /usr/bin/env node\n\nconst program = require('commander');\nconst version = require('../package.json').version;\n\nprogram\n  .version(version)\n  .command('init [dir]')\n  .description('初始化博客')\n  .action(require('../lib/init'));\n\nprogram\n  .command('new <name>')\n  .description('创建新的文章')\n  .action(require('../lib/new.js'));\n\nprogram\n  .command('server [dir]')\n  .description('本地预览网站')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/preview.js'));\n\nprogram\n  .command('build [dir]')\n  .description('将文章渲染为html')\n  .option('-o, --output <dir>', '输出目录')\n  .action(require('../lib/build'));\n\nprogram\n  .command('clean')\n  .description('清空build出来的静态文件')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/clean.js'));\n\nprogram.parse(process.argv);\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"#! /usr/bin/env node\n\nconst program = require('commander');\nconst version = require('../package.json').version;\n\nprogram\n  .version(version)\n  .command('init [dir]')\n  .description('初始化博客')\n  .action(require('../lib/init'));\n\nprogram\n  .command('new <name>')\n  .description('创建新的文章')\n  .action(require('../lib/new.js'));\n\nprogram\n  .command('server [dir]')\n  .description('本地预览网站')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/preview.js'));\n\nprogram\n  .command('build [dir]')\n  .description('将文章渲染为html')\n  .option('-o, --output <dir>', '输出目录')\n  .action(require('../lib/build'));\n\nprogram\n  .command('clean')\n  .description('清空build出来的静态文件')\n  .option('-d, --dir <dir>', 'build时输出的目录')\n  .action(require('../lib/clean.js'));\n\nprogram.parse(process.argv);\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"init"},"children":[{"type":"text","value":"init"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"初始化的时候可以传入一个目录，表示准备初始化的目录，这里我用了"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ES2020"}]},{"type":"text","value":"的新语法"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dir = dir ?? '.'"}]},{"type":"text","value":"，当"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dir"}]},{"type":"text","value":"为"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"null"}]},{"type":"text","value":"或"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"undefined"}]},{"type":"text","value":"时，使用问号右边的值。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在初始化的时候，需要明确好用户使用的目录应该是什么样的"}]},{"type":"element","tag":"code","props":{"code":"Blog\n├─ build\n├─ site.config.json\n├─ source\n│    └─ _posts\n│           └─ blog.md\n└─ theme\n       └─ default\n              ├─ assets\n              └─ layout\n","language":"bash"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Blog\n├─ build\n├─ site.config.json\n├─ source\n│    └─ _posts\n│           └─ blog.md\n└─ theme\n       └─ default\n              ├─ assets\n              └─ layout\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"将预先准备好的模板根据设计的目录拷贝到目标目录下，而不是直接调用项目中的，因为拷贝到目标目录下后，使用者就可以更方便的自定义模板，可以更方便的写自己的样式。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"关于"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"fs-extra"}]},{"type":"text","value":"模块的各种 API 可以查看"},{"type":"element","tag":"a","props":{"href":"https://github.com/jprichardson/node-fs-extra","rel":["nofollow"]},"children":[{"type":"text","value":"fs-extra 文档"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"关于"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dayjs"}]},{"type":"text","value":"可以查看"},{"type":"element","tag":"a","props":{"href":"https://dayjs.gitee.io/zh-CN/","rel":["nofollow"]},"children":[{"type":"text","value":"dayjs 文档"}]}]},{"type":"element","tag":"code","props":{"code":"const path = require('path');\nconst fs = require('fs-extra');\nconst dayjs = require('dayjs');\n\nmodule.exports = (dir) => {\n  dir = dir ?? '.';\n\n  const templateDir = path.resolve(__dirname, '..', 'template');\n  fs.copySync(templateDir, path.resolve(dir));\n  fs.ensureDirSync(path.resolve(dir, 'source'));\n\n  newPost(dir);\n};\n\nfunction newPost(dir) {\n  const firstPost = [\n    '---',\n    'title: Hello World',\n    'date: ' + dayjs().format('YYYY/MM/DD HH:mm:ss'),\n    'tags: ' + '[blog,CoinRailgunn]',\n    'category: ' + 'welcome',\n    '---',\n    '',\n    'Welcome to my blog, this is my first post',\n    '<!-- more -->',\n  ].join('\\n');\n\n  const file = path.resolve(dir, 'source', '_posts', 'hello.md');\n  fs.outputFileSync(file, firstPost);\n\n  console.log(\"博客初始化完成，键入'crn new <postName>'即可创建新的文章\");\n}\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const path = require('path');\nconst fs = require('fs-extra');\nconst dayjs = require('dayjs');\n\nmodule.exports = (dir) => {\n  dir = dir ?? '.';\n\n  const templateDir = path.resolve(__dirname, '..', 'template');\n  fs.copySync(templateDir, path.resolve(dir));\n  fs.ensureDirSync(path.resolve(dir, 'source'));\n\n  newPost(dir);\n};\n\nfunction newPost(dir) {\n  const firstPost = [\n    '---',\n    'title: Hello World',\n    'date: ' + dayjs().format('YYYY/MM/DD HH:mm:ss'),\n    'tags: ' + '[blog,CoinRailgunn]',\n    'category: ' + 'welcome',\n    '---',\n    '',\n    'Welcome to my blog, this is my first post',\n    '<!-- more -->',\n  ].join('\\n');\n\n  const file = path.resolve(dir, 'source', '_posts', 'hello.md');\n  fs.outputFileSync(file, firstPost);\n\n  console.log(\"博客初始化完成，键入'crn new <postName>'即可创建新的文章\");\n}\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"new"},"children":[{"type":"text","value":"new"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"创建新文章的函数和初始化函数有部分的逻辑是相同的，这里我没有将他们封装起来，如果感兴趣的话你们可以试试。创建文章需要传入一个 name，为创建的文章名，然后将其保存至"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"source/_post"}]},{"type":"text","value":"下"}]},{"type":"element","tag":"code","props":{"code":"const fs = require('fs-extra');\nconst path = require('path');\nconst dayjs = require('dayjs');\n\nmodule.exports = (name) => {\n  const post = [\n    '---',\n    `title: ${name}`,\n    'date: ' + dayjs().format('YYYY/MM/DD HH:mm:ss'),\n    'tags: ' + '[blog]',\n    'category: ' + 'code',\n    '---',\n    '',\n  ].join('\\n');\n\n  const file = path.resolve('source', '_posts', `${name}.md`);\n  fs.outputFileSync(file, post);\n\n  console.log(`source/_posts/${name}.md 创建成功！`);\n};\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const fs = require('fs-extra');\nconst path = require('path');\nconst dayjs = require('dayjs');\n\nmodule.exports = (name) => {\n  const post = [\n    '---',\n    `title: ${name}`,\n    'date: ' + dayjs().format('YYYY/MM/DD HH:mm:ss'),\n    'tags: ' + '[blog]',\n    'category: ' + 'code',\n    '---',\n    '',\n  ].join('\\n');\n\n  const file = path.resolve('source', '_posts', `${name}.md`);\n  fs.outputFileSync(file, post);\n\n  console.log(`source/_posts/${name}.md 创建成功！`);\n};\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"build"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"生成静态页是整个项目最关键的部分，因为代码很多这里讲一下我的思路，详细代码可以查看"},{"type":"element","tag":"a","props":{"href":"https://github.com/qiyuor2/CoinRailgun","rel":["nofollow"]},"children":[{"type":"text","value":"项目仓库"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"首先我们要设计好各个页面的 url，以下为我的设计："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"首页："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/index.html"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/page/1/index.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"不同页码："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/page/页码/index.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"文章页："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/categories/分类名/文章名/index.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"关于我页面："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/about/index.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"归档页："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/archives/index.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"分类页："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/categories/index.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"标签页："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/tags/index.html"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"404 页："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/404/index.html"}]},{"type":"text","value":"（这个我忘了做了"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"目前的浏览器会自动隐藏"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"index.html"}]},{"type":"text","value":"，因此使用"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"目录名/index.html"}]},{"type":"text","value":"的方式可以美化页面的地址栏"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"第一步，根据设计好的 url 编写好各个页面"},{"type":"element","tag":"a","props":{"href":"https://github.com/qiyuor2/CoinRailgun/tree/main/template/theme/default/layout","rel":["nofollow"]},"children":[{"type":"text","value":"模板"}]},{"type":"text","value":"，这里我使用的是"},{"type":"element","tag":"a","props":{"href":"https://aui.github.io/art-template/zh-cn/docs/index.html","rel":["nofollow"]},"children":[{"type":"text","value":"art-template"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"template/theme/default/layout/layout.art"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"template/theme/default/layout/page.art"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"其他请查看"},{"type":"element","tag":"a","props":{"href":"https://github.com/qiyuor2/CoinRailgun/tree/main/template/theme/default/layout","rel":["nofollow"]},"children":[{"type":"text","value":"CoinRailgun 默认主题模板"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然后，一些网站的基础数据，比如 author、keywords、description 等，是不会发生改变的，因此需要将他们写在统一的配置文件里"},{"type":"element","tag":"a","props":{"href":"https://github.com/qiyuor2/CoinRailgun/blob/main/template/site.config.json","rel":["nofollow"]},"children":[{"type":"text","value":"site.config.json"}]},{"type":"text","value":"，下面是我的部分配置文件"}]},{"type":"element","tag":"code","props":{"code":"{\n  \"basic\": {\n    \"icon\": \"\",\n    \"avatar\": \"\",\n    \"title\": \"\",\n    \"author\": \"\",\n    \"description\": \"\",\n    \"keywords\": []\n  },\n  \"theme\": {\n    \"name\": \"default\",\n    \"highlight\": \"github-gist\",\n    \"pageSize\": 7,\n    \"exclude\": [\"life\"],\n    \"friends\": [],\n    \"about\": {\n      \"label\": \"about me.\",\n      \"url\": \"/about\"\n    },\n    \"nav\": [\n      {\n        \"name\": \"archives\",\n        \"label\": \"归档\",\n        \"url\": \"/archives\"\n      },\n      {\n        \"name\": \"categories\",\n        \"label\": \"分类\",\n        \"url\": \"/categories\"\n      },\n      {\n        \"name\": \"tags\",\n        \"label\": \"标签\",\n        \"url\": \"/tags\"\n      }\n    ],\n    \"links\": [],\n    \"footer\": {\n      \"beian\": \"\",\n      \"copyright\": {\n        \"year\": \"2019-2021\"\n      }\n    }\n  },\n  \"dev_server\": {\n    \"port\": 3000\n  }\n}\n","language":"json"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{\n  \"basic\": {\n    \"icon\": \"\",\n    \"avatar\": \"\",\n    \"title\": \"\",\n    \"author\": \"\",\n    \"description\": \"\",\n    \"keywords\": []\n  },\n  \"theme\": {\n    \"name\": \"default\",\n    \"highlight\": \"github-gist\",\n    \"pageSize\": 7,\n    \"exclude\": [\"life\"],\n    \"friends\": [],\n    \"about\": {\n      \"label\": \"about me.\",\n      \"url\": \"/about\"\n    },\n    \"nav\": [\n      {\n        \"name\": \"archives\",\n        \"label\": \"归档\",\n        \"url\": \"/archives\"\n      },\n      {\n        \"name\": \"categories\",\n        \"label\": \"分类\",\n        \"url\": \"/categories\"\n      },\n      {\n        \"name\": \"tags\",\n        \"label\": \"标签\",\n        \"url\": \"/tags\"\n      }\n    ],\n    \"links\": [],\n    \"footer\": {\n      \"beian\": \"\",\n      \"copyright\": {\n        \"year\": \"2019-2021\"\n      }\n    }\n  },\n  \"dev_server\": {\n    \"port\": 3000\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在根据 markdown 和模板生成 html 时，我们要确定模板上需要的数据，并且将配置文件和 markdown 的内容转换为模板上的数据"}]},{"type":"element","tag":"code","props":{"code":"<!-- layout/post_item.art -->\n<div class=\"post-item__title\">\n  <a href=\"{{url}}\">{{title}}</a>\n</div>\n<div class=\"post-item__desc\">\n  <p class=\"post-item__desc-date\">\n    <i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>\n    {{date}}\n  </p>\n  <p class=\"post-item__desc-category\">\n    <i class=\"fa fa-folder-o\" aria-hidden=\"true\"></i>\n    <a href=\"/categories\">{{category || ''}}</a>\n  </p>\n</div>\n<div class=\"post-item__abstract\">\n  <p class=\"post-item__abstract-content\">{{@ abstracts}}</p>\n  <p class=\"more\" style=\"display:none;\">\n    <a href=\"{{url}}\">查看更多</a>\n  </p>\n</div>\n<div class=\"post-item__tags\">\n  {{each tags}}\n  <a href=\"/tags\">\n    <i class=\"fa fa-tag\" aria-hidden=\"true\"></i>\n    {{$value}}\n  </a>\n  {{/each}}\n</div>\n","language":"html"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<!-- layout/post_item.art -->\n<div class=\"post-item__title\">\n  <a href=\"{{url}}\">{{title}}</a>\n</div>\n<div class=\"post-item__desc\">\n  <p class=\"post-item__desc-date\">\n    <i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>\n    {{date}}\n  </p>\n  <p class=\"post-item__desc-category\">\n    <i class=\"fa fa-folder-o\" aria-hidden=\"true\"></i>\n    <a href=\"/categories\">{{category || ''}}</a>\n  </p>\n</div>\n<div class=\"post-item__abstract\">\n  <p class=\"post-item__abstract-content\">{{@ abstracts}}</p>\n  <p class=\"more\" style=\"display:none;\">\n    <a href=\"{{url}}\">查看更多</a>\n  </p>\n</div>\n<div class=\"post-item__tags\">\n  {{each tags}}\n  <a href=\"/tags\">\n    <i class=\"fa fa-tag\" aria-hidden=\"true\"></i>\n    {{$value}}\n  </a>\n  {{/each}}\n</div>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"以文章列表项为例，这个模板需要"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"title"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"date"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"category"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"url"}]},{"type":"text","value":"、"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"abstracts"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"tags"}]},{"type":"text","value":"，其中"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"url"}]},{"type":"text","value":"是根据设计好的"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/categories/分类名/文章名/index.html"}]},{"type":"text","value":"生成出来的，其他的参数都是从 markdown 文件中解析出来的，并且这些参数都写在文件头部的 yml 配置中，而"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"abstracts"}]},{"type":"text","value":"一般是使用"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"<!--more-->"}]},{"type":"text","value":"分割出来。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"明确了以上内容后，我们就需要获取这些参数然后传递给模板渲染出来"}]},{"type":"element","tag":"code","props":{"code":"const template = fs.readFileSync(postTemplate, 'utf-8');\nconst content = fs.readFileSync(fullPath, 'utf-8');\nconst fm = require('front-matter');\n\nfunction renderAbstracts() {\n  // ....\n}\n\nconst postItem = art.render(template, {\n  ...fm(content).attributes,\n  abstracts: renderAbstracts(),\n});\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const template = fs.readFileSync(postTemplate, 'utf-8');\nconst content = fs.readFileSync(fullPath, 'utf-8');\nconst fm = require('front-matter');\n\nfunction renderAbstracts() {\n  // ....\n}\n\nconst postItem = art.render(template, {\n  ...fm(content).attributes,\n  abstracts: renderAbstracts(),\n});\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这样我们就得到了渲染后的文章列表项，然后再传入"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"post_list.art"}]},{"type":"text","value":" 渲染出来文章列表后传入"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"page.art"}]},{"type":"text","value":"中，与其他的数据相组合拿到完整的一个页面。渲染出页面后使用"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"fs.outputFileSync"}]},{"type":"text","value":"将页面保存到一开始设计好的目录中"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"build/page/1/index.html"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"大致思路就是这样，更多具体实现可以查看"},{"type":"element","tag":"a","props":{"href":"https://github.com/qiyuor2/CoinRailgun","rel":["nofollow"]},"children":[{"type":"text","value":"项目仓库"}]}]},{"type":"element","tag":"h3","props":{"id":"server"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"生成所有页面后，就可以开启本地预览了，这里我使用的是"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"koa"}]},{"type":"text","value":"，使用"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"express"}]},{"type":"text","value":"或者其他的框架都是大差不差的。直接将 build 目录设置为静态资源即可访问。"}]},{"type":"element","tag":"code","props":{"code":"const Koa = require('koa');\nconst staticServe = require('koa-static');\nconst path = require('path');\n\nmodule.exports = (dir, options) => {\n  dir = dir ?? '.';\n  const app = new Koa();\n\n  const siteConfig = require(path.resolve(dir, 'site.config.json'));\n\n  const outputDir = path.resolve(dir, options.dir ?? 'build');\n  app.use(staticServe(outputDir));\n\n  app.listen(siteConfig.dev_server.port, () => {\n    console.log(\n      `在浏览器中打开 http://localhost:${siteConfig.dev_server.port} 以预览网页`\n    );\n  });\n};\n","language":"js"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const Koa = require('koa');\nconst staticServe = require('koa-static');\nconst path = require('path');\n\nmodule.exports = (dir, options) => {\n  dir = dir ?? '.';\n  const app = new Koa();\n\n  const siteConfig = require(path.resolve(dir, 'site.config.json'));\n\n  const outputDir = path.resolve(dir, options.dir ?? 'build');\n  app.use(staticServe(outputDir));\n\n  app.listen(siteConfig.dev_server.port, () => {\n    console.log(\n      `在浏览器中打开 http://localhost:${siteConfig.dev_server.port} 以预览网页`\n    );\n  });\n};\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这样我们就了解了制作一个静态博客生成器的思路和过程。"}]},{"type":"element","tag":"h2","props":{"id":"参考文章"},"children":[{"type":"text","value":"参考文章"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://qiankaijie.com/13.%E6%89%8B%E6%91%B8%E6%89%8B%E6%95%99%E4%BD%A0%E6%92%B8%E4%B8%80%E4%B8%AA%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E7%94%9F%E6%88%90%E5%99%A8.html","rel":["nofollow"]},"children":[{"type":"text","value":"手摸手教你撸一个静态网站生成器"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://juejin.cn/post/6844903503651930119","rel":["nofollow"]},"children":[{"type":"text","value":"自己动手撸一个静态博客生成器"}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"明确需求","depth":2,"text":"明确需求"},{"id":"开始编写","depth":2,"text":"开始编写","children":[{"id":"安装依赖","depth":3,"text":"安装依赖"},{"id":"搭建项目结构","depth":3,"text":"搭建项目结构"},{"id":"crnjs","depth":3,"text":"crn.js"},{"id":"init","depth":3,"text":"init"},{"id":"new","depth":3,"text":"new"},{"id":"build","depth":3,"text":"build"},{"id":"server","depth":3,"text":"server"}]},{"id":"参考文章","depth":2,"text":"参考文章"}]}},"_type":"markdown","_id":"content:2021:simple-blog-generate.md","_source":"content","_file":"2021/simple-blog-generate.md","_extension":"md"},"hash":"yEY33jdn4b"}