{"parsed":{"_path":"/2020/ts-strategy","_dir":"2020","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"TypeScript实现设计模式——策略模式","description":"","excerpt":{"type":"root","children":[{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"策略模式（Strategy）：它定义了算法家族，分别封装起来，让它们之间可以互相替换，此模式让算法的变化不会影响到使用算法的客户。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"——《大话设计模式》"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"策略模式主要用来解决当有多种相似算法的时，使用 if...else 产生的难以维护的问题。它主要由三部分组成：Strategy 接口、具体的 Strategy 类以及用来改变和执行策略的 Context 类。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"接下来将以一个超市选择优惠活动的例子实现策略模式。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Strategy 接口"}]}]},{"type":"element","tag":"code","props":{"code":"interface Strategy {\n  /**\n   * 优惠活动\n   * @param money 原价\n   * @returns 现价\n   */\n  discount(money: number): number;\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"interface Strategy {\n  /**\n   * 优惠活动\n   * @param money 原价\n   * @returns 现价\n   */\n  discount(money: number): number;\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"具体的优惠策略"}]}]},{"type":"element","tag":"code","props":{"code":"// 满减优惠\nclass FullAndReduceStrategy implements Strategy {\n  // 满足条件的金额\n  private conditionMoney: number;\n  // 减少的金额\n  private reduceMoney: number;\n\n  constructor(money: number, returnMoney: number) {\n    this.conditionMoney = money;\n    this.reduceMoney = returnMoney;\n  }\n\n  public discount(money: number): number {\n    let result: number;\n\n    if (money >= this.conditionMoney) {\n      result =\n        money - Math.floor(money / this.conditionMoney) * this.reduceMoney;\n    }\n\n    return result;\n  }\n}\n\n// 现金折扣\nclass CashRebateStrategy implements Strategy {\n  // 折扣值\n  private moneyRabte: number;\n\n  constructor(moneyRabte: number) {\n    this.moneyRabte = moneyRabte;\n  }\n\n  discount(money: number): number {\n    return money * this.moneyRabte;\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// 满减优惠\nclass FullAndReduceStrategy implements Strategy {\n  // 满足条件的金额\n  private conditionMoney: number;\n  // 减少的金额\n  private reduceMoney: number;\n\n  constructor(money: number, returnMoney: number) {\n    this.conditionMoney = money;\n    this.reduceMoney = returnMoney;\n  }\n\n  public discount(money: number): number {\n    let result: number;\n\n    if (money >= this.conditionMoney) {\n      result =\n        money - Math.floor(money / this.conditionMoney) * this.reduceMoney;\n    }\n\n    return result;\n  }\n}\n\n// 现金折扣\nclass CashRebateStrategy implements Strategy {\n  // 折扣值\n  private moneyRabte: number;\n\n  constructor(moneyRabte: number) {\n    this.moneyRabte = moneyRabte;\n  }\n\n  discount(money: number): number {\n    return money * this.moneyRabte;\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Context 类"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"setStrategy"}]},{"type":"text","value":"方法用来控制要使用的策略，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"execute"}]},{"type":"text","value":"方法用来执行策略。"}]},{"type":"element","tag":"code","props":{"code":"class Context {\n  private strategy: Strategy;\n  private money: number;\n\n  constructor(money: number) {\n    this.money = money;\n  }\n\n  // 设置优惠策略\n  public setStrategy(strategy: Strategy): void {\n    this.strategy = strategy;\n  }\n\n  // 执行策略\n  public execute(): number {\n    return this.strategy.discount(this.money);\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"class Context {\n  private strategy: Strategy;\n  private money: number;\n\n  constructor(money: number) {\n    this.money = money;\n  }\n\n  // 设置优惠策略\n  public setStrategy(strategy: Strategy): void {\n    this.strategy = strategy;\n  }\n\n  // 执行策略\n  public execute(): number {\n    return this.strategy.discount(this.money);\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"测试"}]}]},{"type":"element","tag":"code","props":{"code":"const context: Context = new Context(100);\n\ncontext.setStrategy(new FullAndReduceStrategy(50, 2));\nconsole.log(context.execute()); // 96\n\ncontext.setStrategy(new CashRebateStrategy(0.5));\nconsole.log(context.execute()); // 50\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const context: Context = new Context(100);\n\ncontext.setStrategy(new FullAndReduceStrategy(50, 2));\nconsole.log(context.execute()); // 96\n\ncontext.setStrategy(new CashRebateStrategy(0.5));\nconsole.log(context.execute()); // 50\n"}]}]}]}]},"date":"2020/03/21 17:29:07","tags":["TypeScript","设计模式"],"category":"技术","summary":"策略模式（Strategy）：它定义了算法家族，分别封装起来，让它们之间可以互相替换，此模式让算法的变化不会影响到使用算法的客户。——《大话设计模式》","body":{"type":"root","children":[{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"策略模式（Strategy）：它定义了算法家族，分别封装起来，让它们之间可以互相替换，此模式让算法的变化不会影响到使用算法的客户。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"——《大话设计模式》"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"策略模式主要用来解决当有多种相似算法的时，使用 if...else 产生的难以维护的问题。它主要由三部分组成：Strategy 接口、具体的 Strategy 类以及用来改变和执行策略的 Context 类。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"接下来将以一个超市选择优惠活动的例子实现策略模式。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Strategy 接口"}]}]},{"type":"element","tag":"code","props":{"code":"interface Strategy {\n  /**\n   * 优惠活动\n   * @param money 原价\n   * @returns 现价\n   */\n  discount(money: number): number;\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"interface Strategy {\n  /**\n   * 优惠活动\n   * @param money 原价\n   * @returns 现价\n   */\n  discount(money: number): number;\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"具体的优惠策略"}]}]},{"type":"element","tag":"code","props":{"code":"// 满减优惠\nclass FullAndReduceStrategy implements Strategy {\n  // 满足条件的金额\n  private conditionMoney: number;\n  // 减少的金额\n  private reduceMoney: number;\n\n  constructor(money: number, returnMoney: number) {\n    this.conditionMoney = money;\n    this.reduceMoney = returnMoney;\n  }\n\n  public discount(money: number): number {\n    let result: number;\n\n    if (money >= this.conditionMoney) {\n      result =\n        money - Math.floor(money / this.conditionMoney) * this.reduceMoney;\n    }\n\n    return result;\n  }\n}\n\n// 现金折扣\nclass CashRebateStrategy implements Strategy {\n  // 折扣值\n  private moneyRabte: number;\n\n  constructor(moneyRabte: number) {\n    this.moneyRabte = moneyRabte;\n  }\n\n  discount(money: number): number {\n    return money * this.moneyRabte;\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// 满减优惠\nclass FullAndReduceStrategy implements Strategy {\n  // 满足条件的金额\n  private conditionMoney: number;\n  // 减少的金额\n  private reduceMoney: number;\n\n  constructor(money: number, returnMoney: number) {\n    this.conditionMoney = money;\n    this.reduceMoney = returnMoney;\n  }\n\n  public discount(money: number): number {\n    let result: number;\n\n    if (money >= this.conditionMoney) {\n      result =\n        money - Math.floor(money / this.conditionMoney) * this.reduceMoney;\n    }\n\n    return result;\n  }\n}\n\n// 现金折扣\nclass CashRebateStrategy implements Strategy {\n  // 折扣值\n  private moneyRabte: number;\n\n  constructor(moneyRabte: number) {\n    this.moneyRabte = moneyRabte;\n  }\n\n  discount(money: number): number {\n    return money * this.moneyRabte;\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Context 类"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"setStrategy"}]},{"type":"text","value":"方法用来控制要使用的策略，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"execute"}]},{"type":"text","value":"方法用来执行策略。"}]},{"type":"element","tag":"code","props":{"code":"class Context {\n  private strategy: Strategy;\n  private money: number;\n\n  constructor(money: number) {\n    this.money = money;\n  }\n\n  // 设置优惠策略\n  public setStrategy(strategy: Strategy): void {\n    this.strategy = strategy;\n  }\n\n  // 执行策略\n  public execute(): number {\n    return this.strategy.discount(this.money);\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"class Context {\n  private strategy: Strategy;\n  private money: number;\n\n  constructor(money: number) {\n    this.money = money;\n  }\n\n  // 设置优惠策略\n  public setStrategy(strategy: Strategy): void {\n    this.strategy = strategy;\n  }\n\n  // 执行策略\n  public execute(): number {\n    return this.strategy.discount(this.money);\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"测试"}]}]},{"type":"element","tag":"code","props":{"code":"const context: Context = new Context(100);\n\ncontext.setStrategy(new FullAndReduceStrategy(50, 2));\nconsole.log(context.execute()); // 96\n\ncontext.setStrategy(new CashRebateStrategy(0.5));\nconsole.log(context.execute()); // 50\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const context: Context = new Context(100);\n\ncontext.setStrategy(new FullAndReduceStrategy(50, 2));\nconsole.log(context.execute()); // 96\n\ncontext.setStrategy(new CashRebateStrategy(0.5));\nconsole.log(context.execute()); // 50\n"}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:2020:ts-strategy.md","_source":"content","_file":"2020/ts-strategy.md","_extension":"md"},"hash":"x7D4Ja2jSt"}