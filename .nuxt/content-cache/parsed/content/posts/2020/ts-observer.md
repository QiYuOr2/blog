{"parsed":{"_path":"/posts/2020/ts-observer","_dir":"2020","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"TypeScript实现设计模式——观察者模式","description":"观察者模式是一种行为设计模式，允许一个对象将其状态的改变通知其他对象。","excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"观察者模式"}]},{"type":"text","value":"是一种行为设计模式，允许一个对象将其状态的改变通知其他对象。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者模式提供了一种作用于任何实现了订阅者接口的对象的机制， 可对其事件进行订阅和取消订阅。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"","src":"https://refactoringguru.cn/images/patterns/content/observer/observer.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"图片来源："},{"type":"element","tag":"a","props":{"href":"https://refactoringguru.cn/design-patterns/observer","rel":["nofollow"]},"children":[{"type":"text","value":"https://refactoringguru.cn/design-patterns/observer"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者模式是一种在前端领域应用十分广泛的设计模式，特别是在图形界面的组件中，如果你自定义了一个按钮组件，那么你很可能需要用到观察者模式。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者模式的核心成员有两个，一个是作为事件发布者的 Subject 类，另一个是作为事件接收者的 Observer 类。"}]},{"type":"element","tag":"h3","props":{"id":"subject-部分"},"children":[{"type":"text","value":"Subject 部分"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Subject 类所具有的公共部分是对订阅者的管理和向所有订阅者发布消息，而具体 Subject 所负责的业务逻辑需要放到各自的 Subject 类中。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Subject 接口"}]}]},{"type":"element","tag":"code","props":{"code":"interface Subject {\n  // 添加观察者\n  attach(observer: Observer): void;\n  // 移除观察者\n  detach(observer: Observer): void;\n  // 通知所有观察者\n  notify(): void;\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"interface Subject {\n  // 添加观察者\n  attach(observer: Observer): void;\n  // 移除观察者\n  detach(observer: Observer): void;\n  // 通知所有观察者\n  notify(): void;\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"具体 Subject 类"}]}]},{"type":"element","tag":"code","props":{"code":"class ConcreteSubject implements Subject {\n  // 发布者状态，测试使用\n  public state: number;\n\n  // 订阅者名单\n  public observers: Array<Observer> = [];\n\n  // 管理订阅方法\n  public attach(observer: Observer): void {\n    const observerIndex = this.observers.indexOf(observer);\n    if (observerIndex !== -1) {\n      return console.log('已订阅');\n    }\n\n    this.observers.push(observer);\n    console.log('订阅成功');\n  }\n\n  public detach(observer: Observer): void {\n    const observerIndex = this.observers.indexOf(observer);\n    if (observerIndex === -1) {\n      return console.log('订阅者未订阅');\n    }\n\n    this.observers.splice(observerIndex, 1);\n    console.log('订阅者已移除');\n  }\n\n  public notify(): void {\n    console.log('通知所有订阅者');\n    for (const observer of this.observers) {\n      observer.update(this);\n    }\n  }\n\n  // 订阅管理以外的逻辑\n  public someLogic() {\n    this.state = Math.floor(Math.random() * 10 + 1);\n\n    console.log(`我更改了我的状态：state=${this.state}`);\n    this.notify();\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"class ConcreteSubject implements Subject {\n  // 发布者状态，测试使用\n  public state: number;\n\n  // 订阅者名单\n  public observers: Array<Observer> = [];\n\n  // 管理订阅方法\n  public attach(observer: Observer): void {\n    const observerIndex = this.observers.indexOf(observer);\n    if (observerIndex !== -1) {\n      return console.log('已订阅');\n    }\n\n    this.observers.push(observer);\n    console.log('订阅成功');\n  }\n\n  public detach(observer: Observer): void {\n    const observerIndex = this.observers.indexOf(observer);\n    if (observerIndex === -1) {\n      return console.log('订阅者未订阅');\n    }\n\n    this.observers.splice(observerIndex, 1);\n    console.log('订阅者已移除');\n  }\n\n  public notify(): void {\n    console.log('通知所有订阅者');\n    for (const observer of this.observers) {\n      observer.update(this);\n    }\n  }\n\n  // 订阅管理以外的逻辑\n  public someLogic() {\n    this.state = Math.floor(Math.random() * 10 + 1);\n\n    console.log(`我更改了我的状态：state=${this.state}`);\n    this.notify();\n  }\n}\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"observer-部分"},"children":[{"type":"text","value":"Observer 部分"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者只需要根据发布者的发出的消息来判断自己是否需要做出回应即可。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Observer 接口"}]}]},{"type":"element","tag":"code","props":{"code":"interface Observer {\n  // 对发布者发出的更新消息作出回应\n  update(subject: Subject): void;\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"interface Observer {\n  // 对发布者发出的更新消息作出回应\n  update(subject: Subject): void;\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"具体 Observer 类"}]}]},{"type":"element","tag":"code","props":{"code":"//具体观察者A\nclass ConcreteObserverA implements Observer {\n  public update(subject: ConcreteSubject) {\n    if (subject.state <= 5) {\n      console.log('观察者A作出回应');\n    }\n  }\n}\n\n// 具体观察者B\nclass ConcreteObserverB implements Observer {\n  public update(subject: ConcreteSubject) {\n    if (subject.state > 5) {\n      console.log('观察者B作出回应');\n    }\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"//具体观察者A\nclass ConcreteObserverA implements Observer {\n  public update(subject: ConcreteSubject) {\n    if (subject.state <= 5) {\n      console.log('观察者A作出回应');\n    }\n  }\n}\n\n// 具体观察者B\nclass ConcreteObserverB implements Observer {\n  public update(subject: ConcreteSubject) {\n    if (subject.state > 5) {\n      console.log('观察者B作出回应');\n    }\n  }\n}\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"测试代码"},"children":[{"type":"text","value":"测试代码"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"因为是随机数，可能会得不到想要的结果，可以多尝试几次"}]},{"type":"element","tag":"code","props":{"code":"const subject = new ConcreteSubject();\n\nconst observerA = new ConcreteObserverA();\nsubject.attach(observerA);\n\nconst observerB = new ConcreteObserverB();\nsubject.attach(observerB);\n\nsubject.someLogic();\n\nsubject.detach(observerB);\n\nsubject.someLogic();\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const subject = new ConcreteSubject();\n\nconst observerA = new ConcreteObserverA();\nsubject.attach(observerA);\n\nconst observerB = new ConcreteObserverB();\nsubject.attach(observerB);\n\nsubject.someLogic();\n\nsubject.detach(observerB);\n\nsubject.someLogic();\n"}]}]}]}]},"date":"2020/04/16 17:55:55","tags":["TypeScript","设计模式"],"category":"技术","summary":"观察者模式是一种行为设计模式，允许一个对象将其状态的改变通知其他对象。观察者模式提供了一种作用于任何实现了订阅者接口的对象的机制， 可对其事件进行订阅和取消订阅。","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"观察者模式"}]},{"type":"text","value":"是一种行为设计模式，允许一个对象将其状态的改变通知其他对象。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者模式提供了一种作用于任何实现了订阅者接口的对象的机制， 可对其事件进行订阅和取消订阅。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"","src":"https://refactoringguru.cn/images/patterns/content/observer/observer.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"图片来源："},{"type":"element","tag":"a","props":{"href":"https://refactoringguru.cn/design-patterns/observer","rel":["nofollow"]},"children":[{"type":"text","value":"https://refactoringguru.cn/design-patterns/observer"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者模式是一种在前端领域应用十分广泛的设计模式，特别是在图形界面的组件中，如果你自定义了一个按钮组件，那么你很可能需要用到观察者模式。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者模式的核心成员有两个，一个是作为事件发布者的 Subject 类，另一个是作为事件接收者的 Observer 类。"}]},{"type":"element","tag":"h3","props":{"id":"subject-部分"},"children":[{"type":"text","value":"Subject 部分"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Subject 类所具有的公共部分是对订阅者的管理和向所有订阅者发布消息，而具体 Subject 所负责的业务逻辑需要放到各自的 Subject 类中。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Subject 接口"}]}]},{"type":"element","tag":"code","props":{"code":"interface Subject {\n  // 添加观察者\n  attach(observer: Observer): void;\n  // 移除观察者\n  detach(observer: Observer): void;\n  // 通知所有观察者\n  notify(): void;\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c72a9"},"children":[{"type":"text","value":"interface"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"Subject"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 添加观察者"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"attach"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-8a8662"},"children":[{"type":"text","value":"observer"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 移除观察者"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"detach"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-8a8662"},"children":[{"type":"text","value":"observer"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 通知所有观察者"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"notify"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"具体 Subject 类"}]}]},{"type":"element","tag":"code","props":{"code":"class ConcreteSubject implements Subject {\n  // 发布者状态，测试使用\n  public state: number;\n\n  // 订阅者名单\n  public observers: Array<Observer> = [];\n\n  // 管理订阅方法\n  public attach(observer: Observer): void {\n    const observerIndex = this.observers.indexOf(observer);\n    if (observerIndex !== -1) {\n      return console.log('已订阅');\n    }\n\n    this.observers.push(observer);\n    console.log('订阅成功');\n  }\n\n  public detach(observer: Observer): void {\n    const observerIndex = this.observers.indexOf(observer);\n    if (observerIndex === -1) {\n      return console.log('订阅者未订阅');\n    }\n\n    this.observers.splice(observerIndex, 1);\n    console.log('订阅者已移除');\n  }\n\n  public notify(): void {\n    console.log('通知所有订阅者');\n    for (const observer of this.observers) {\n      observer.update(this);\n    }\n  }\n\n  // 订阅管理以外的逻辑\n  public someLogic() {\n    this.state = Math.floor(Math.random() * 10 + 1);\n\n    console.log(`我更改了我的状态：state=${this.state}`);\n    this.notify();\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c72a9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"ConcreteSubject"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"implements"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-67e536"},"children":[{"type":"text","value":"Subject"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 发布者状态，测试使用"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-618f87"},"children":[{"type":"text","value":"state"}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-34737a"},"children":[{"type":"text","value":"number"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 订阅者名单"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-618f87"},"children":[{"type":"text","value":"observers"}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e011ed"},"children":[{"type":"text","value":"Array"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-e011ed"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"> "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" [];"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 管理订阅方法"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"attach"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-8a8662"},"children":[{"type":"text","value":"observer"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e718c8"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-05da5c"},"children":[{"type":"text","value":"observerIndex"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-56ee21"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":".observers."}]},{"type":"element","tag":"span","props":{"class":"ct-163f56"},"children":[{"type":"text","value":"indexOf"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"(observer);"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" (observerIndex "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"!=="}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-030dd8"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"'已订阅'"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-47abb5"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":".observers."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"push"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"(observer);"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"'订阅成功'"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"detach"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-8a8662"},"children":[{"type":"text","value":"observer"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e718c8"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-05da5c"},"children":[{"type":"text","value":"observerIndex"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-56ee21"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":".observers."}]},{"type":"element","tag":"span","props":{"class":"ct-163f56"},"children":[{"type":"text","value":"indexOf"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"(observer);"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" (observerIndex "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-030dd8"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"'订阅者未订阅'"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-47abb5"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":".observers."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"splice"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"(observerIndex, "}]},{"type":"element","tag":"span","props":{"class":"ct-030dd8"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"'订阅者已移除'"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"notify"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"'通知所有订阅者'"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-e718c8"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-05da5c"},"children":[{"type":"text","value":"observer"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"of"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-56ee21"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":".observers) {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"      observer."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"update"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-47abb5"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 订阅管理以外的逻辑"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"someLogic"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"() {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-47abb5"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":".state "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"Math"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"floor"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"Math"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"random"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-030dd8"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-030dd8"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"`我更改了我的状态：state="}]},{"type":"element","tag":"span","props":{"class":"ct-29db5f"},"children":[{"type":"text","value":"${"}]},{"type":"element","tag":"span","props":{"class":"ct-47abb5"},"children":[{"type":"text","value":"this"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-47abb5"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"notify"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"observer-部分"},"children":[{"type":"text","value":"Observer 部分"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"观察者只需要根据发布者的发出的消息来判断自己是否需要做出回应即可。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Observer 接口"}]}]},{"type":"element","tag":"code","props":{"code":"interface Observer {\n  // 对发布者发出的更新消息作出回应\n  update(subject: Subject): void;\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c72a9"},"children":[{"type":"text","value":"interface"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 对发布者发出的更新消息作出回应"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"update"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-8a8662"},"children":[{"type":"text","value":"subject"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"Subject"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6f566d"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"具体 Observer 类"}]}]},{"type":"element","tag":"code","props":{"code":"//具体观察者A\nclass ConcreteObserverA implements Observer {\n  public update(subject: ConcreteSubject) {\n    if (subject.state <= 5) {\n      console.log('观察者A作出回应');\n    }\n  }\n}\n\n// 具体观察者B\nclass ConcreteObserverB implements Observer {\n  public update(subject: ConcreteSubject) {\n    if (subject.state > 5) {\n      console.log('观察者B作出回应');\n    }\n  }\n}\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"//具体观察者A"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c72a9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"ConcreteObserverA"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"implements"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-67e536"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"update"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-8a8662"},"children":[{"type":"text","value":"subject"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"ConcreteSubject"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" (subject.state "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"<="}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-030dd8"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"      console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"'观察者A作出回应'"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-dcf9b5"},"children":[{"type":"text","value":"// 具体观察者B"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-9c72a9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"ConcreteObserverB"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"implements"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-67e536"},"children":[{"type":"text","value":"Observer"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"update"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-8a8662"},"children":[{"type":"text","value":"subject"}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-483d7f"},"children":[{"type":"text","value":"ConcreteSubject"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" (subject.state "}]},{"type":"element","tag":"span","props":{"class":"ct-0bcc9b"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-030dd8"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"      console."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e2cfd7"},"children":[{"type":"text","value":"'观察者B作出回应'"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"  }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"测试代码"},"children":[{"type":"text","value":"测试代码"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"因为是随机数，可能会得不到想要的结果，可以多尝试几次"}]},{"type":"element","tag":"code","props":{"code":"const subject = new ConcreteSubject();\n\nconst observerA = new ConcreteObserverA();\nsubject.attach(observerA);\n\nconst observerB = new ConcreteObserverB();\nsubject.attach(observerB);\n\nsubject.someLogic();\n\nsubject.detach(observerB);\n\nsubject.someLogic();\n","language":"typescript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e718c8"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-05da5c"},"children":[{"type":"text","value":"subject"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-163f56"},"children":[{"type":"text","value":"ConcreteSubject"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e718c8"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-05da5c"},"children":[{"type":"text","value":"observerA"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-163f56"},"children":[{"type":"text","value":"ConcreteObserverA"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"subject."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"attach"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"(observerA);"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e718c8"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-05da5c"},"children":[{"type":"text","value":"observerB"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-12348d"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-163f56"},"children":[{"type":"text","value":"ConcreteObserverB"}]},{"type":"element","tag":"span","props":{"class":"ct-ee28b9"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"subject."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"attach"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"(observerB);"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"subject."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"someLogic"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"subject."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"detach"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"(observerB);"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"subject."}]},{"type":"element","tag":"span","props":{"class":"ct-3429b5"},"children":[{"type":"text","value":"someLogic"}]},{"type":"element","tag":"span","props":{"class":"ct-4d6a78"},"children":[{"type":"text","value":"();"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-29db5f{color:#0A3069}.ct-47abb5{color:#0550AE}.ct-e2cfd7{color:#0A3069}.ct-030dd8{color:#0550AE}.ct-163f56{color:#8250DF}.ct-56ee21{color:#0550AE}.ct-05da5c{color:#0550AE}.ct-e718c8{color:#CF222E}.ct-e011ed{color:#953800}.ct-34737a{color:#0550AE}.ct-618f87{color:#953800}.ct-12348d{color:#CF222E}.ct-ee28b9{color:#24292F}.ct-67e536{color:#0550AE}.ct-6f566d{color:#0550AE}.ct-0bcc9b{color:#CF222E}.ct-8a8662{color:#953800}.ct-3429b5{color:#8250DF}.ct-dcf9b5{color:#6E7781}.ct-483d7f{color:#953800}.ct-4d6a78{color:#24292F}.ct-9c72a9{color:#CF222E}.sepia .ct-9c72a9{color:#66D9EF}.dark .ct-9c72a9{color:#FF7B72}.sepia .ct-4d6a78{color:#F8F8F2}.dark .ct-4d6a78{color:#C9D1D9}.sepia .ct-483d7f{color:#A6E22E}.dark .ct-483d7f{color:#FFA657}.sepia .ct-dcf9b5{color:#88846F}.dark .ct-dcf9b5{color:#8B949E}.sepia .ct-3429b5{color:#A6E22E}.dark .ct-3429b5{color:#D2A8FF}.sepia .ct-8a8662{color:#FD971F}.dark .ct-8a8662{color:#FFA657}.sepia .ct-0bcc9b{color:#F92672}.dark .ct-0bcc9b{color:#FF7B72}.sepia .ct-6f566d{color:#66D9EF}.dark .ct-6f566d{color:#79C0FF}.sepia .ct-67e536{color:#A6E22E}.dark .ct-67e536{color:#79C0FF}.dark .ct-ee28b9{color:#C9D1D9}.sepia .ct-ee28b9{color:#F8F8F2}.dark .ct-12348d{color:#FF7B72}.sepia .ct-12348d{color:#F92672}.dark .ct-618f87{color:#FFA657}.sepia .ct-618f87{color:#F8F8F2}.dark .ct-34737a{color:#79C0FF}.sepia .ct-34737a{color:#66D9EF}.dark .ct-e011ed{color:#FFA657}.sepia .ct-e011ed{color:#A6E22E}.dark .ct-e718c8{color:#FF7B72}.sepia .ct-e718c8{color:#66D9EF}.dark .ct-05da5c{color:#79C0FF}.sepia .ct-05da5c{color:#F8F8F2}.dark .ct-56ee21{color:#79C0FF}.sepia .ct-56ee21{color:#FD971F}.dark .ct-163f56{color:#D2A8FF}.sepia .ct-163f56{color:#A6E22E}.sepia .ct-030dd8{color:#AE81FF}.dark .ct-030dd8{color:#79C0FF}.sepia .ct-e2cfd7{color:#E6DB74}.dark .ct-e2cfd7{color:#A5D6FF}.sepia .ct-47abb5{color:#FD971F}.dark .ct-47abb5{color:#79C0FF}.sepia .ct-29db5f{color:#F92672}.dark .ct-29db5f{color:#A5D6FF}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"subject-部分","depth":3,"text":"Subject 部分"},{"id":"observer-部分","depth":3,"text":"Observer 部分"},{"id":"测试代码","depth":3,"text":"测试代码"}]}},"_type":"markdown","_id":"content:posts:2020:ts-observer.md","_source":"content","_file":"posts/2020/ts-observer.md","_extension":"md"},"hash":"RRPo98e6Xg"}