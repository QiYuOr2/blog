{"parsed":{"_path":"/posts/2019/chsarp-sql-helper","_dir":"2019","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"C# 封装SqlHelper","description":"老师在讲C#实战项目时所使用的SqlHelper，使用的数据库是SQL Server","excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"老师在讲C#实战项目时所使用的SqlHelper，使用的数据库是SQL Server"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"注意，连接数据库的连接字符串需要在配置文件中设置好"}]}]},{"type":"element","tag":"code","props":{"code":"<appSettings>\n    <add key = \"connString\" value=\"data source = .; database = CourseSelectionInfo; integrated security = true\"/>\n</appSettings>\n","language":"XML"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<appSettings>\n    <add key = \"connString\" value=\"data source = .; database = CourseSelectionInfo; integrated security = true\"/>\n</appSettings>\n"}]}]}]},{"type":"element","tag":"code","props":{"code":"public class SqlHelper\n{\n    #region 连接字符串connString\n    private static string connString;\n    static SqlHelper()\n    {\n        connString = ConfigurationManager.AppSettings[\"connString\"];\n    }\n    #endregion\n\n    #region 增删改int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 增删改\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>修改了几行</returns>\n    public static int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteNonQuery();\n            }\n        }\n    }\n    #endregion\n\n    #region 获取一个数据 T ExcuteScalar<T>(string cmdText,  CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取一个数据<T>\n    /// </summary>\n    /// <typeparam name=\"T\">数据类型</typeparam>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>任意类型的数据</returns>\n    public static T ExcuteScalar<T>(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return (T)cmd.ExecuteScalar();\n            }\n        }\n    }\n    #endregion\n\n    #region 读取数据表SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 读取数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>SqlDataReader</returns>\n    public static SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        SqlConnection connection = new SqlConnection(connString);\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteReader(CommandBehavior.CloseConnection);\n            }\n    }\n    #endregion\n\n    #region 临时数据库DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据库\n    /// </summary>\n    /// <param name=\"cmdText\"></param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\"></param>\n    /// <returns></returns>\n    public static DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        DataSet ds = new DataSet();\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                using (SqlDataAdapter adapter = new SqlDataAdapter(cmd))\n                {\n                    if (parameters.Length > 0)\n                    {\n                        adapter.SelectCommand.Parameters.AddRange(parameters);\n                    }\n                    adapter.Fill(ds);\n                }\n            }\n        }\n        return ds;\n    }\n    #endregion\n\n    #region 临时数据表DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns></returns>\n    public static DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        return GetDataSet(cmdText, cmdType, parameters).Tables[0];\n    }\n    #endregion\n}\n","language":"cs"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"public class SqlHelper\n{\n    #region 连接字符串connString\n    private static string connString;\n    static SqlHelper()\n    {\n        connString = ConfigurationManager.AppSettings[\"connString\"];\n    }\n    #endregion\n\n    #region 增删改int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 增删改\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>修改了几行</returns>\n    public static int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteNonQuery();\n            }\n        }\n    }\n    #endregion\n\n    #region 获取一个数据 T ExcuteScalar<T>(string cmdText,  CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取一个数据<T>\n    /// </summary>\n    /// <typeparam name=\"T\">数据类型</typeparam>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>任意类型的数据</returns>\n    public static T ExcuteScalar<T>(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return (T)cmd.ExecuteScalar();\n            }\n        }\n    }\n    #endregion\n\n    #region 读取数据表SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 读取数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>SqlDataReader</returns>\n    public static SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        SqlConnection connection = new SqlConnection(connString);\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteReader(CommandBehavior.CloseConnection);\n            }\n    }\n    #endregion\n\n    #region 临时数据库DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据库\n    /// </summary>\n    /// <param name=\"cmdText\"></param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\"></param>\n    /// <returns></returns>\n    public static DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        DataSet ds = new DataSet();\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                using (SqlDataAdapter adapter = new SqlDataAdapter(cmd))\n                {\n                    if (parameters.Length > 0)\n                    {\n                        adapter.SelectCommand.Parameters.AddRange(parameters);\n                    }\n                    adapter.Fill(ds);\n                }\n            }\n        }\n        return ds;\n    }\n    #endregion\n\n    #region 临时数据表DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns></returns>\n    public static DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        return GetDataSet(cmdText, cmdType, parameters).Tables[0];\n    }\n    #endregion\n}\n"}]}]}]}]},"date":"2019/08/23 21:48:47","tags":["CSharp","SQL Server"],"category":"技术","summary":"老师在讲C#实战项目时所使用的SqlHelper，使用的数据库是SQL Server","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"老师在讲C#实战项目时所使用的SqlHelper，使用的数据库是SQL Server"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"注意，连接数据库的连接字符串需要在配置文件中设置好"}]}]},{"type":"element","tag":"code","props":{"code":"<appSettings>\n    <add key = \"connString\" value=\"data source = .; database = CourseSelectionInfo; integrated security = true\"/>\n</appSettings>\n","language":"XML"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<appSettings>\n    <add key = \"connString\" value=\"data source = .; database = CourseSelectionInfo; integrated security = true\"/>\n</appSettings>"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"public class SqlHelper\n{\n    #region 连接字符串connString\n    private static string connString;\n    static SqlHelper()\n    {\n        connString = ConfigurationManager.AppSettings[\"connString\"];\n    }\n    #endregion\n\n    #region 增删改int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 增删改\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>修改了几行</returns>\n    public static int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteNonQuery();\n            }\n        }\n    }\n    #endregion\n\n    #region 获取一个数据 T ExcuteScalar<T>(string cmdText,  CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取一个数据<T>\n    /// </summary>\n    /// <typeparam name=\"T\">数据类型</typeparam>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>任意类型的数据</returns>\n    public static T ExcuteScalar<T>(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return (T)cmd.ExecuteScalar();\n            }\n        }\n    }\n    #endregion\n\n    #region 读取数据表SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 读取数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>SqlDataReader</returns>\n    public static SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        SqlConnection connection = new SqlConnection(connString);\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteReader(CommandBehavior.CloseConnection);\n            }\n    }\n    #endregion\n\n    #region 临时数据库DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据库\n    /// </summary>\n    /// <param name=\"cmdText\"></param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\"></param>\n    /// <returns></returns>\n    public static DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        DataSet ds = new DataSet();\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                using (SqlDataAdapter adapter = new SqlDataAdapter(cmd))\n                {\n                    if (parameters.Length > 0)\n                    {\n                        adapter.SelectCommand.Parameters.AddRange(parameters);\n                    }\n                    adapter.Fill(ds);\n                }\n            }\n        }\n        return ds;\n    }\n    #endregion\n\n    #region 临时数据表DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns></returns>\n    public static DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        return GetDataSet(cmdText, cmdType, parameters).Tables[0];\n    }\n    #endregion\n}\n","language":"cs"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"public class SqlHelper\n{\n    #region 连接字符串connString\n    private static string connString;\n    static SqlHelper()\n    {\n        connString = ConfigurationManager.AppSettings[\"connString\"];\n    }\n    #endregion\n\n    #region 增删改int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 增删改\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>修改了几行</returns>\n    public static int ExcuteNonQuery(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteNonQuery();\n            }\n        }\n    }\n    #endregion\n\n    #region 获取一个数据 T ExcuteScalar<T>(string cmdText,  CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取一个数据<T>\n    /// </summary>\n    /// <typeparam name=\"T\">数据类型</typeparam>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>任意类型的数据</returns>\n    public static T ExcuteScalar<T>(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return (T)cmd.ExecuteScalar();\n            }\n        }\n    }\n    #endregion\n\n    #region 读取数据表SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 读取数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns>SqlDataReader</returns>\n    public static SqlDataReader ExcuteReader(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        SqlConnection connection = new SqlConnection(connString);\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                connection.Open();\n                if (parameters.Length > 0)\n                {\n                    cmd.Parameters.AddRange(parameters);\n                }\n                return cmd.ExecuteReader(CommandBehavior.CloseConnection);\n            }\n    }\n    #endregion\n\n    #region 临时数据库DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据库\n    /// </summary>\n    /// <param name=\"cmdText\"></param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\"></param>\n    /// <returns></returns>\n    public static DataSet GetDataSet(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        DataSet ds = new DataSet();\n        using (SqlConnection connection = new SqlConnection(connString))\n        {\n            using (SqlCommand cmd = new SqlCommand(cmdText, connection))\n            {\n                cmd.CommandType = cmdType;\n                using (SqlDataAdapter adapter = new SqlDataAdapter(cmd))\n                {\n                    if (parameters.Length > 0)\n                    {\n                        adapter.SelectCommand.Parameters.AddRange(parameters);\n                    }\n                    adapter.Fill(ds);\n                }\n            }\n        }\n        return ds;\n    }\n    #endregion\n\n    #region 临时数据表DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    /// <summary>\n    /// 获取临时数据表\n    /// </summary>\n    /// <param name=\"cmdText\">sql</param>\n    /// <param name=\"cmdType\"></param>\n    /// <param name=\"parameters\">参数</param>\n    /// <returns></returns>\n    public static DataTable GetDataTable(string cmdText, CommandType cmdType, params SqlParameter[] parameters)\n    {\n        return GetDataSet(cmdText, cmdType, parameters).Tables[0];\n    }\n    #endregion\n}"}]}]}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:posts:2019:chsarp-sql-helper.md","_source":"content","_file":"posts/2019/chsarp-sql-helper.md","_extension":"md"},"hash":"22an9A6Q1S"}